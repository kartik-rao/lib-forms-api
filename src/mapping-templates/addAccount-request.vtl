#foreach($group in $context.identity.claims.get("cognito:groups"))
    #if($group == "Admin")
        #set($inCognitoGroup = true)
    #end
#end
#if($inCognitoGroup)
    #set($attribs = $context.arguments.input)
    #set($attribs.id = $util.autoId())
    #set($attribs.owner = $context.identity.sub)
    #set($createdAt = $util.time.nowISO8601())
    {
        "version": "2017-02-28",
        "operation": "PutItem",
        "key": {
            "partitionKey": {"S" : "${attribs.id}"},
            "sortKey"     : {"S" : "ACCOUNT"}
        },
        "attributeValues": {
            "indexKey"  : {"S" : "FREE"},
            "type"      : {"S" : "ACCOUNT"},
            "owner"     : {"S" : "$context.identity.sub"},
            "isDeleted" : {"BOOL": false },
            "createdAt" : {"S" : "$createdAt"},
            "itemData"  : $util.dynamodb.toDynamoDBJson($attribs)
        },
        "condition": {
            "expression": "attribute_not_exists(#partitionKey)",
                "expressionNames": {
                "#partitionKey": "partitionKey",
            }
        }
    }
#else
    $utils.unauthorized()
#end