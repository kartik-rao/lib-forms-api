#set($identity=$ctx.stash.identity)
#set($args=$ctx.arguments)

#if($identity.isAdmin == true)
    $util.qr($ctx.stash.put("operation", 'query'))
    #set ($request = {})
    $util.qr($request.put("itemType", 'ACCOUNT'))
    $util.qr($request.put("limit", $ctx.args.limit))
    $util.qr($request.put("nextToken", $ctx.args.nextToken))
    $util.qr($request.put("filter", $util.defaultIfNull($args.filter, {})))
    #if($util.isNull($args.filter.planTypeId))
        $util.qr($request.filter.put("meta", {"begins_with" : "${args.filter.planTypeId}"}))
    #end
    #if(!$util.isNull($ctx.stash.request))
        #set ($ctx.stash.prevRequest = $ctx.stash.request)
    #end
    $util.qr($ctx.stash.put("request", $request))
    #return({})
#else
    $util.error("User [${ctx.stash.identity.callerId}] cannot execute [${request.operation}] on [${request.itemType}]", "Unauthorized")
#end