type MasterData @model {
    partitionKey: ID!
    sortKey: ID!
    indexKey: String!
    type: String!
    data: AWSJSON!
}

type FormEntry @model {
    partitionKey: ID!
    sortKey: ID!
    indexKey: String!
    data: AWSJSON!
}

type Form {
    id: ID!
    owner: ID!
    exid: String
    desc: String
    name: String!
    tenant: AWSJSON
    status: AWSJSON
    content: AWSJSON!
    layout: AWSJSON
    formLayoutOptions: AWSJSON
    stopSubmit: Boolean
    submitTarget: String
    successRedirect: String
    errorRedirect: String
}

type PaginatedForm {
  items: [Form!]!
  nextToken: String
}

type User {
  id: ID!
  owner: ID!
  accountId: String!
  email: String!
  group: String!
  given_name: String!
  family_name: String!
  phone_number: AWSPhone
  createdAt: AWSDate
}

type UserInput {
  email: String!
  group: String!
  given_name: String!
  family_name: String!
  phone_number: AWSPhone
}

type PaginatedUser {
  items: [User!]!
  nextToken: String
}

type Account {
  id: ID!
  name: String!
  owner: ID!
  planId: ID!
  createdAt: AWSDate!
  updatedDate: AWSDate!
  lastBillDate: AWSDate
}

type AccountInput {
  name: String!
  planId: ID!
}

type PaginatedAccount {
  items: [Account!]!
  nextToken: String!
}

type PlanType {
  planTypeId: ID!
  owner: ID!
  name: String!
  cost: Float!
  active: Boolean!
  billingTerm: String!
}

type PlanTypeInput {
  name: String!
  cost: Float!
  billingTerm: String!
}

type PaginatedPlanType {
  items: [PlanType!]!
  nextToken: String!
}

type Plan {
  planId: ID!
  accountId: ID!
  owner: ID!
  planTypeId: ID!
  startDate: AWSDate!
  endDate: AWSDate
  active: Boolean
  lastBillDate: AWSDate
}

type PlanInput {
  accountId: ID!
  planTypeId: ID!
  endDate: AWSData
  active: Boolean
}

type PaginatedPlan {
  items: [Plan!]!
  nextToken: String
}

type IntegrationType {
  integrationTypeId: ID!
  PlanTypeId: ID!
  name: String!
  active: Boolean!
}

type IntegrationTypeInput {
  name: String!
  active: Boolean
}

type PaginatedIntegrationType {
  items: [IntegrationType!]!
  nextToken: String
}

type Integration {
  integrationId: ID!
  integrationTypeId: ID!
  owner: ID!
  accountId: ID!
  formId: ID!
  active: Boolean!
  authType: String
  auth: AWSJSON
  target: String
  method: String
  lastExecuted: AWSDate
  lastExecutionResult: Boolean
  lastExecutionResultMessage: String
}

type IntegrationInput {
  integrationTypeId: ID!
  accountId: ID!
  formId: ID!
  active: Boolean
  authType: String
  auth: AWSJSON
  target: String
  method: String
}

type PaginatedIntegration {
  items: [Integration!]!
  nextToken: String
}

type Query {
  getAccount(accountId: ID!): Account!
  @aws_auth(cognito_groups: ["Admin", "AccountAdmin"])

  listAllAccounts(limit: Int, nextToken: String): PaginatedAccount!
  @aws_auth(cognito_groups: ["Admin"])

  getUser(userId: String!): User!
  @aws_auth(cognito_groups: ["Admin", "AccountAdmin"])

  listAllUsers(limit: Int, nextToken: String) : PaginatedUser!
  @aws_auth(cognito_groups: ["Admin"])

  listAllAccountUsers(accountId: String!, limit: Int, nextToken: String): PaginatedUser!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin"])

  listAllAccountUsersActive(accountId: String!, limit: Int, nextToken: String): PaginatedUser!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin"])

  listAccountUsersInGroup(accountId: String!, group: String!, limit: Int, nextToken: String): PaginatedUser!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin"])

  getPlan(planId: String!): Plan!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin"])

  listAllPlans(limit: Int, nextToken: String): PaginatedPlan!
  @aws_auth(cognito_groups: ["Admin"])

  listAllAccountPlans(accountId: String!, limit: Int, nextToken: String): PaginatedPlan!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin"])

  getActiveAccountPlan(accountId: String!): PaginatedPlan!
  @aws_auth(cognito_groups: ["AccountAdmin", "User", "Admin"])

  getPlanType(planTypeId: String!): PlanType!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin"])

  listAllPlanTypes(limit: Int, nextToken: String): PaginatedPlanType!
  @aws_auth(cognito_groups: ["Admin"])

  listAllActivePlanTypes(limit: Int, nextToken: String): PaginatedPlanType!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin"])

  getForm(formId: String!) : Form!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin"])

  listAllForms(limit: Int, nextToken: String) : PaginatedForm!
  @aws_auth(cognito_groups: ["Admin"])

  listAllAccountForms(accountId: String!, limit: Int, nextToken: String) : PaginatedForm!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin", "User"])

  listAllAccountFormsActive(accountId: String!, active: String!, limit: Int, nextToken: String) : PaginatedForm!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin", "User"])

  listAllAccountFormsByUser(accountId: String!, userId: String!, limit: Int, nextToken: String) : PaginatedForm!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin", "User"])

  listAllAccountFormsByUserActive(accountId: String!, userId: String!, active: String!, limit: Int, nextToken: String) : PaginatedForm!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin", "User"])

  getIntegrationType(integrationTypeId: String!): IntegrationType!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin"])

  listAllIntegrationTypes(limit: Int, nextToken: String): PaginatedIntegrationType!
  @aws_auth(cognito_groups: ["Admin"])

  listAllIntegrationTypesByPlanType(planTypeId: String!, limit: Int, nextToken: String): PaginatedIntegrationType!
  @aws_auth(cognito_groups: ["Admin"])

  listAllIntegrationTypesByPlanTypeActive(planTypeId: String!, active: String!, limit: Int, nextToken: String): PaginatedIntegrationType!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin"])

  getIntegration(integrationId: String!): Integration!
  @aws_auth(cognito_groups: ["Admin"])

  listAllIntegrations(limit: Int, nextToken: String): PaginatedIntegration!
  @aws_auth(cognito_groups: ["Admin"])

  listAllAccountIntegrations(accountId: String!, limit: Int, nextToken: String): PaginatedIntegration!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin"])

  listAllAccountFormIntegrations(accountId: String!, formId: String!, limit: Int, nextToken: String): PaginatedIntegration!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin", "User"])

  listAllAccountFormIntegrationsActive(accountId: String!, formId: String!, active: String!, limit: Int, nextToken: String): PaginatedIntegration!
  @aws_auth(cognito_groups: ["AccountAdmin"])

  getFormEntry(formEntryId: String!): FormEntry!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin", "User"])

  listAllFormEntries(formId: String!) : PaginatedFormEntries!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin", "User"])

  listAllFormEntriesByTime(formId: String!, timestampPrefix: String!): PaginatedFormEntries!
  @aws_auth(cognito_groups: ["AccountAdmin", "Admin", "User"])
}

type Mutation {
  addAccount(id: ID!, name: String!, planId: String!, content: AWSJSON): MasterData!
  @aws_auth(cognito_groups: ["Admin", "AccountAdmin"])

  deleteAccount(AccountId: ID!): MasterData!
  @aws_auth(cognito_groups: ["Admin"])
}

type Schema {
  query: Query
  mutation: Mutation
}